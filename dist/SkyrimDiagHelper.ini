[SkyrimDiagHelper]
; Seconds without main-thread heartbeat to consider a hang
HangThresholdInGameSec=10
; Exiting the game usually happens from menus and can take longer than normal gameplay stalls.
; Use a more conservative threshold in menus to avoid generating hang dumps on normal shutdown.
HangThresholdInMenuSec=30
; Modpack environments can take several minutes to load. 10 minutes is a practical default.
HangThresholdLoadingSec=600

; Alt-Tab/background pause handling:
; When Skyrim is not the foreground window, it may intentionally stop the main thread/heartbeat.
; To avoid generating hang dumps just because the user Alt-Tabs, suppress auto hang dumps while not foreground.
; Set to 0 if you want background hangs to still generate dumps (may increase false positives).
SuppressHangWhenNotForeground=1
; When returning to foreground after a background pause, wait a short grace period before capturing a hang.
; This avoids false hang dumps if the game resumes heartbeats a moment after focus is restored.
ForegroundGraceSec=5

; 0=MiniDumpNormal, 1=WithThreadInfo+HandleData+UnloadedModules (default), 2=FullMemory
DumpMode=1

; Output directory for dumps/logs (blank = next to exe)
OutputDir=

; Retention / disk cleanup (0 = unlimited)
; SkyrimDiag writes crash/hang/manual dumps plus derived artifacts (Summary/Report/Blackbox, WCT JSON, ETL traces).
MaxCrashDumps=20
MaxHangDumps=20
MaxManualDumps=20
MaxEtwTraces=5

; Helper log rotation (0 = unlimited)
MaxHelperLogBytes=8388608
MaxHelperLogFiles=3

; Manual capture hotkey (Ctrl+Shift+F12) to avoid waiting for the loading threshold.
EnableManualCaptureHotkey=1

; Automatically run DumpTool after a dump is written.
; This creates easy-to-read files next to the dump (Summary.json / Report.txt / Blackbox.jsonl).
AutoAnalyzeDump=1
; WinUI viewer path (full replacement mode).
DumpToolExe=SkyrimDiagWinUI\SkyrimDiagDumpToolWinUI.exe

; Beginner-friendly viewer auto-open policy:
; - Crash: auto-open only if Skyrim exits soon (avoids popups for handled first-chance exceptions)
; - Hang: queue latest hang dump and open viewer after Skyrim exits
; - Manual capture: no viewer auto-open by default
AutoOpenViewerOnCrash=1
AutoOpenCrashOnlyIfProcessExited=1
AutoOpenCrashWaitForExitMs=2000
; Optional: when the same crash bucket repeatedly fails to resolve fault module,
; run one extra FullMemory recapture (best-effort, only if process is still alive).
EnableAutoRecaptureOnUnknownCrash=0
AutoRecaptureUnknownBucketThreshold=2
AutoRecaptureAnalysisTimeoutSec=20
AutoOpenViewerOnHang=1
AutoOpenViewerOnManualCapture=0
AutoOpenHangAfterProcessExit=1
AutoOpenHangDelayMs=2000
AutoOpenViewerBeginnerMode=1

; Adaptive loading threshold:
; Learns recent "Loading Menu" durations and adjusts hang detection for loading screens.
; - Fast setups: captures infinite loading in a few minutes
; - Heavy setups: avoids false positives on long loads
EnableAdaptiveLoadingThreshold=1
AdaptiveLoadingMinSec=120
AdaptiveLoadingMinExtraSec=120
AdaptiveLoadingMaxSec=1800

; Optional ETW capture around hang dump generation (advanced, OFF by default).
; Requires Windows Performance Recorder (wpr.exe).
; Best-effort only: ETW capture failure does NOT block dump/WCT generation.
EnableEtwCaptureOnHang=0
EtwWprExe=wpr.exe
EtwHangProfile=GeneralProfile
EtwHangFallbackProfile=
EtwMaxDurationSec=20
